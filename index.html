
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>ç¢³æ’æ”¾è¨ˆç®—å™¨ï¼ˆ1aï¼‰</title>
  <style>
    body { font-family: sans-serif; padding: 2em; background: #f6f6f6; max-width: 800px; margin: auto; }
    h1 { color: #2c3e50; }
    label { display: block; margin: 6px 0; }
    input, select { padding: 6px; width: 120px; }
    button { margin-top: 1em; padding: 10px 16px; background: #4CAF50; color: white; border: none; cursor: pointer; }
    .output { margin-top: 1em; font-size: 1.1em; }
  </style>
</head>
<body>
  <h1>ğŸ“˜ ç¢³æ’æ”¾è¨ˆç®—å™¨ - 1a è£½ç¨‹ä¹™ç‚”</h1>
  <label>GWP ç‰ˆæœ¬ï¼š
    <select id="gwp">
      <option value="25">AR4</option>
      <option value="28">AR5</option>
      <option value="29.8" selected>AR6</option>
    </select>
  </label>
  <div id="inputs"></div>
  <button onclick="calculate()">è¨ˆç®—</button>
  <button onclick="exportCSV()">åŒ¯å‡º CSV</button>

  <div class="output" id="output"></div>

  <script>
    const inputsDiv = document.getElementById("inputs");
    for (let i = 1; i <= 12; i++) {
      inputsDiv.innerHTML += `<label>${i} æœˆæ´»å‹•æ•¸æ“š (kg)ï¼š<input type="number" id="m${i}" value="0"></label>`;
    }

    function calculate() {
      const gwp = parseFloat(document.getElementById("gwp").value);
      let total = 0;
      for (let i = 1; i <= 12; i++) {
        const val = parseFloat(document.getElementById("m" + i).value) || 0;
        total += val;
      }
      const emission = total * 1.5 * gwp;
      document.getElementById("output").innerHTML = `ğŸ”¢ å¹´æ’æ”¾é‡ä¼°ç®—ï¼š<strong>${emission.toFixed(2)} kg COâ‚‚e</strong>`;
    }

    function exportCSV() {
      const gwp = parseFloat(document.getElementById("gwp").value);
      let csv = "æœˆä»½,ç”¨é‡ (kg),æ’æ”¾ä¿‚æ•¸,GWP,COâ‚‚eæ’æ”¾é‡\n";
      for (let i = 1; i <= 12; i++) {
        const amount = parseFloat(document.getElementById("m" + i).value) || 0;
        const factor = 1.5;
        const co2e = amount * factor * gwp;
        csv += `${i},${amount},${factor},${gwp},${co2e.toFixed(2)}\n`;
      }
      const blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
      const a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = "1a_ç¢³æ’æ”¾å ±è¡¨.csv";
      a.click();
    }
  </script>
</body>
</html>
